<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="js/jquery-3.6.0.js"></script>
</head>
<body>
    <div>購物車</div>
    <table>
        <thead>
            <th>商品id</th>
            <th>數量</th>
        </thead>
        <tbody>
            <!-- <tr>
                <td>bd0106</td>
                <td>2</td>
            </tr>
            <tr>
                <td>bd0108</td>
                <td>2</td>
            </tr> -->
        </tbody>
        
    </table>
    <button id="clr">清空購物車</button>
    <script>
        $(function(){
            var newcarts = JSON.parse(localStorage.getItem('carts'));

            // console.log(newcarts);
            
            if(newcarts){
                 newcarts.forEach( function(e){
                var data = {name:e.name}
                $.ajax({
                            url: "/buy", //cake.js 的buy頁 
                            type: "POST",
                            contentType: "application/json; charset=utf-8",
                            data: JSON.stringify(data),
                            success: function(res) {
                            // console.log(res);
                            $("tbody").append(`<tr><td>${res}</td><td>${e.quantity}</td></tr>`);
                            },
                            error: function() {
                                alert("Add 系統錯誤!");
                                
                            }
                            })
                
            });
            }
           
            
           

            $('#clr').on('click',function(){
            localStorage.removeItem('carts')
        })



        })
        
    </script>
</body>
</html>