<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/08-14.css">
    <link rel="stylesheet" href="../css/main_ginnychen19.css">
    <link rel="stylesheet" href="../css/BEndOrder.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <title>菓季-一般訂單</title>
    <style>
        /* 字型引用 */
        @font-face {
            font-family: 'GenSenRounded-B';
            src: local("GenSenRounded-B"),
                url('../Source/ttc/GenSenRounded-B.ttc') format("woff"),
                url('../Source/ttc/GenSenRounded-B.ttc') format("opentype"),
                url('../Source/ttc/GenSenRounded-B.ttc') format("embedded-opentype");
        }

        /* 色票表 */
        :root {
            --sky: #a6dbf5;

            --Green01: #368284;
            --Green02: #628e59;
            --Green03: #A3CF78;
            --Green04: #87c379;

            --YWhite: #F6F3E4;
            --GWhite: #F7F8F3;

            --BG_LYellow: #f0da99;
            --BG_LOrange: #F3D1B2;
            --BG_MOrange: #f7bc88;

            --Brown01: #5c3a31;
            --Brown02: #835B36;
            --Brown03: #BB8058;

            --Brown04_BE: #b79779;
            --Brown05_BEtxt: #876464;

            --BTN_Red: #e3344b;
            --BTN_Green: #337e47;
            --BTN_Yellow: #f39800;
        }

        /* 字型套用 */
        body {
            font-family: GenSenRounded-B !important;
            background-color: var(--Green03);
        }

        nav {
            --bg: #D0EBF6;
            --color: #5c3a31;
            display: flex;
            justify-content: space-between;
            height: 70px;
            width: 100%;
            line-height: 70px;
            background-color: var(--bg);
            color: var(--color);
            padding: 0 30px;
            position: fixed;
            top: 0;
            z-index: 50;
        }

        nav>div>img {
            width: 20%;
        }

        nav span {
            margin-left: 10px;
            color: #8C623E;
            font-size: 1.3rem;
        }

        #navlist>a {
            /* padding: 0px 10px; */
            margin-right: 30px;
            text-decoration: none;
            color: #8C623E;
            font-size: 1.3rem;
        }

        #navlist>svg {
            padding: 0px 10px;
            width: 50px;
            color: #8C623E;
        }

        /* ----------------AD----------------- */
        #carouselExampleIndicators {
            margin-top: 30px;
            width: 100%;
        }

        /* ----------------------------------------- */
        #footer>img {
            width: 100vw;
        }

        footer {
            position: relative;
            width: 100%;
            min-width: 1440px;
            background-image: url(../Source/IMG/Key-Vision/middle_long.png);
            background-position: top;
            background-size: 60%;
            background-repeat: repeat-x;
            z-index: 3;
            height: 600px;
            color: var(--GWhite);
        }

        #footer {
            position: absolute;
            bottom: 0;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 30px 30px 0px 30px;
            color: var(--YWhite);
        }

        #icon {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
        }

        #icon>div {
            margin: 50px;
        }

        #icon a>img {
            width: 50px;
            margin: 0 10px;
        }
    </style>
</head>

<body class="generalOrderPage" style="margin: 0;">
    <!-- nav-->
    <nav>
        <div>
            <img src="../Source/IMG/Logo.png" alt="Logo">
            <span>菓季</span>
        </div>
        <div id="navlist">
            <a href="/C01/0">主題蛋糕</a>
            <a href="/C02">客製蛋糕</a>
            <a href="/C03">餡料食材介紹</a>
            <a href="/C04">常見問題</a>
            <% if(!session.user) { %>
                <a href="/C05"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor"
                    class="bi bi-person-fill" viewBox="0 0 16 16">
                    <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3Zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
                  </svg></a>
                <% }else if(session.user.rights){%>
                  <a href="/C05_2/1"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor"
                      class="bi bi-person-fill" viewBox="0 0 16 16">
                      <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3Zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
                    </svg></a>
                  <%}else{%>
                    <a href="/C05_4/1"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor"
                        class="bi bi-person-fill" viewBox="0 0 16 16">
                        <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3Zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
                      </svg></a>
                    <%}%>
                      <a href="/C06"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor"
                          class="bi bi-cart3" viewBox="0 0 16 16">
                          <path
                            d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .49.598l-1 5a.5.5 0 0 1-.465.401l-9.397.472L4.415 11H13a.5.5 0 0 1 0 1H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l.84 4.479 9.144-.459L13.89 4H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" />
                        </svg></a>
        </div>
    </nav>

    <!-- 預留固定nav的位置 -->
    <!-- <div class="team_leader">
        <form action="/logout">
            <input type="submit" value="登出">
        </form>
    </div> -->
    <!-- 預留固定輪播的位置 -->
    <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active"
                aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" class="active"
                aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" class="active"
                aria-label="Slide 3"></button>
        </div>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="../Source/IMG/ad1.png" class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item active">
                <img src="../Source/IMG/ad1.png" class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item active">
                <img src="../Source/IMG/ad1.png" class="d-block w-100" alt="...">
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators"
            data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators"
            data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>


    <!-- 上面的選單 -->
    <div class="generalOrder">
        <div class="generalOrdernav">
            <ul>
                <!-- <li>會員資訊</li>
                <li class="Ordernavbuttom">我的訂單</li>
                <li>我的客製</li> -->
                <a href="/C05_4_1">
                    <li>會員資訊</li>
                </a>
                <a href="/C05_4/1">
                    <li>一般訂單</li>
                </a>
                <a href="/C05_4_2/1">
                    <li>客製訂單</li>
                </a>
            </ul>
        </div>
        <!-- 下面的選單 -->
        <div class="generalOrderDataArea">
            <table>
                <thead>
                    <tr class="generaDatanav">
                        <td>訂單</td>
                        <td>下訂日期</td>
                        <td>預定日期</td>
                        <td>狀態</td>
                        <td>總計</td>

                        <!-- <td>訂單</td> -->
                        <td>
                            <select class="generaDataselect">
                                <option value="">30日內訂單</option>
                                <option value="">60日內訂單</option>
                                <option value="">90日內訂單</option>
                            </select>
                        </td>
                    </tr>
                </thead>
                <% data.forEach((item ,index1)=> { %>
                    <% var upYY=item.co_upload_date.getFullYear()%>
                        <% var upMM=(item.co_upload_date.getMonth())+1%>
                            <% var upDD=item.co_upload_date.getDate()%>
                                <% var upHr=item.co_upload_date.getHours()%>
                                    <% var upMi=item.co_upload_date.getMinutes()%>
                                        <% var puYY=item.pick_up_date.getFullYear()%>
                                            <% var puMM=(item.pick_up_date.getMonth())+1%>
                                                <% var puDD=item.pick_up_date.getDate()%>
                                                    <% var puHr=item.pick_up_date.getHours()%>
                                                        <% var puMi=item.pick_up_date.getMinutes()%>
                                                            <tbody>
                                                                <tr class="generaDatalist">
                                                                    <td>#<%= item.o_id%>
                                                                    </td>
                                                                    <td>
                                                                        <%= `${upYY}年${upMM}月${upDD}日${upHr}時${upMi}分`
                                                                            %>
                                                                    </td>
                                                                    <td>
                                                                        <%= `${puYY}年${puMM}月${puDD}日${puHr}時${puMi}分`
                                                                            %>
                                                                    </td>
                                                                    <td>
                                                                        <%= item.co_state%>
                                                                    </td>
                                                                    <td>NT.<%= item.order_total%>
                                                                    </td>
                                                                    <td>
                                                                        <%= item.payment %>
                                                                    </td>
                                                                    <!-- <td><button class="cancelbutton">申請取消</button></td> -->
                                                                    <td><button class="show_details_btn">訂單詳細+</button>
                                                                    </td>
                                                                </tr>
                                                                <tr class="showgeneraDatalist hide">
                                                                    <td colspan="8">
                                                                        <div>
                                                                            <table class="Detail">
                                                                                <thead>
                                                                                    <tr>
                                                                                        <td>訂購內容</td>
                                                                                        <td>數量</td>
                                                                                        <td>單價</td>
                                                                                        <td>小計</td>
                                                                                        <td>付款方式</td>
                                                                                        <td>取貨方式</td>


                                                                                    </tr>
                                                                                </thead>
                                                                                <% var i=1 %>
                                                                                    <% order_D.forEach((o_item
                                                                                        ,index2)=> { %>
                                                                                        <% if(item.o_id===o_item.o_id){
                                                                                            %>

                                                                                            <!-- <tbody>
                                                <tr>
                                                    <td>
                                                    <%= o_item.c_name%>
                                                    </td>
                                                    <td><%= o_item.quantity %></td>
                                                    <td><%= o_item.price%></td>
                                                    <td><%= o_item.total%></td>
                                                    
                                                    <td ><%= item.pickup_method%><br>宅配地址<br>台中市南屯區公益路18號 </td>
                                                    
                                                  
                                                </tr>
                                            </tbody> -->
                                                                                            <tbody>
                                                                                                <tr>
                                                                                                    <td>
                                                                                                        <%=
                                                                                                            o_item.c_name%>
                                                                                                    </td>
                                                                                                    <td>
                                                                                                        <%= o_item.quantity
                                                                                                            %>
                                                                                                    </td>
                                                                                                    <td>NT.<%=
                                                                                                            o_item.price%>
                                                                                                    </td>
                                                                                                    <td>NT.<%=
                                                                                                            o_item.total%>
                                                                                                    </td>
                                                                                                    <% if(i==1 ) { %>
                                                                                                        <td>
                                                                                                            <%= item.payment
                                                                                                                %>
                                                                                                        </td>
                                                                                                        <td>
                                                                                                            <%=
                                                                                                                item.pickup_method%>
                                                                                                                <br>宅配地址<br>台中市南屯區公益路18號
                                                                                                        </td>
                                                                                                        <!-- <td><button class="cancelbutton">申請取消</button></td> -->
                                                                                                        <% i=0%>
                                                                                                            <% }%>
                                                                                                </tr>
                                                                                            </tbody>

                                                                                            <% }%>
                                                                                                <% }) %>


                                                                            </table>

                                                                        </div>


                                                                    </td>

                                                                </tr>
                                                            </tbody>
                                                            <% }) %>
                                                                <!-- <tbody>
                    <tr class="generaDatalist">
                        <td>#123456</td>
                        <td>23.01.30</td>
                        <td>23.02.16</td>
                        <td>未製作</td>
                        <td>NT.1280</td>
                        <td><button class="show_details_btn">訂單詳細 +</button></td>
                    </tr>
                    <tr class="showgeneraDatalist hide">
                        <td colspan="6">
                            <div>
                                <table class="Detail">
                                    <thead>
                                        <tr>
                                            <td>訂購內容</td>
                                            <td>單價</td>
                                            <td>付款方式</td>
                                            <td>取貨方式</td>
                                            <td></td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>黑森林蛋糕10吋</td>
                                            <td>NT.500</td>
                                            <td>信用卡</td>
                                            <td>冷凍宅配-NT180<br>宅配地址<br>台中市南屯區公益路18號 </td>
                                            <td><button class="cancelbutton">申請取消</button></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </td>
                    </tr>
                </tbody> -->

            </table>

        </div>
    </div>

    <!-- 預留固定footer的位置 -->
    <footer>
        <div id="footer">
            <div id="icon">
                <div>
                    <img id="footerLogo" src="../Source/IMG/Logo.png" alt="Logo" style="width: 100px;">
                    <a href="https://www.facebook.com/ispanTaipei" target="_blank"><img src="../Source/IMG/FB.png"
                            alt=""></a>
                    <a href="https://www.instagram.com/5gutlab_zicehui/" target="_blank"><img src="../Source/IMG/ig.png"
                            alt=""></a>
                    <a onclick="self.location.href='mailto:iservice@ispan.com.tw;'"><img src="../Source/IMG/mail.png"
                            alt=""></a>
                </div>
                <div>
                    <h4>訂購電話</h4>
                    <h6>04-1234567</h6><br>
                    <h4>營業時間</h4>
                    <h6>週二-週日10:00至19:00 每週一公休</h6><br>
                    <h4>地址</h4>
                    <h6>台中市南屯區公益路二段(國泰世華大樓18樓)</h6>
                </div>
            </div>
            <div>
                <small>Copyright © 2023 MFEE32 第一組. All rights reserved.</small>
            </div>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script>
        /*開細節按鈕用的*/
        //console.log($(".show_details_btn"));
        $(".show_details_btn").click(function () {
            //console.log($(this).parent().parent().next())
            const showgeneraDatalist = $(this).parent().parent().next();
            $(showgeneraDatalist).toggleClass('hide');


            /*為了讓細節表格-取貨方式、付款方式、按鈕可以維持置中所寫的*/
            const RowspanNub = $(showgeneraDatalist).find("tbody>tr").length;
            const tdRowspan = $(showgeneraDatalist).find("tbody>tr").eq(0).children().eq(1).nextAll();
            tdRowspan.each(function (ind, elem) {
                //console.log(ind, elem);
                $(elem).attr({
                    "rowspan": RowspanNub,
                });
            })

        })
    </script>
    <!-- ---------------------------引用區---------------------------------------- -->
    <script src="./js/_js/jquery-3.6.0.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        crossorigin="anonymous"></script>
</body>

</html>