<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="js/jquery-3.6.0.js"></script>
    <title>Document</title>
</head>

<body>
    <div>會員資料修改</div>
   
   <% var YY = data.birthday.getFullYear().toString()%>
   <% var MM = (data.birthday.getMonth()+1).toString().padStart(2,'0')%>
   <% var DD = data.birthday.getDate().toString().padStart(2,'0')%>
   <% var BD = YY+'-' + MM + '-'+DD %>
   e-mail<input type="text" value=<%= data.email %> readonly > <br>
    <form id="member">
        密碼<input type="password" name="pwd" value=<%= data.pwd %>> <br>
        姓名<input type="text" name="m_name" value=<%= data.m_name %>> <br>
        生日<input type="date" name="birthday" value=<%= BD %>> <br>
        性別<input type="text" name="gender" value=<%= data.gender %>> <br>
        手機<input type="text" name="phone" value=<%= data.phone %>> <br>
        地址<input type="text" name="address" value=<%= data.address %>> <br>
        <input type="button" id="updata" value="修改">
    </form>

<script>
$('#updata').on('click', function() {
            var data = $('#member').serializeArray();
         
            // console.log(file)
           
          
            
            var JSONData = {m_id: <%= session.user.m_id %> }; //注意!!! 需先登入!!!!不然報錯!!!!!!
                  
            for (index in data) {
                JSONData[data[index].name] = data[index].value;
            }
             
                    
            $.ajax({
                url: "/C05_4_2",
                type: "POST", 
                contentType: "application/json; charset=utf-8",
              
                data: JSON.stringify(JSONData),
                success: function(res) {
                    alert("ok");
                    location.href = '/';
                },
                error: function() {
                    alert("系統錯誤!")
                }
            })
        })
</script>

</body>

</html>